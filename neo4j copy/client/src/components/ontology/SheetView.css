/* Sheet View Modal */
.sheet-modal {
  background: var(--pf-bg, #fff); border-radius: 12px;
  width: 94vw; max-width: 1400px; height: 85vh;
  display: flex; flex-direction: column;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

/* Header */
.sheet-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 20px; border-bottom: 1px solid var(--pf-border, #e5e7eb);
  flex-shrink: 0; gap: 16px;
}
.sheet-title h3 { margin: 0; font-size: 15px; }
.sheet-subtitle { font-size: 11px; color: var(--pf-text-muted, #9ca3af); }
.sheet-toolbar { display: flex; align-items: center; gap: 8px; }
.sheet-search {
  padding: 5px 10px; border: 1px solid var(--pf-border, #e5e7eb); border-radius: 6px;
  font-size: 12px; width: 200px; background: var(--pf-bg-subtle, #f9fafb);
}
.sheet-search-wrap { position: relative; display: flex; align-items: center; }
.sheet-search-wrap .sheet-search { padding-right: 24px; }
.search-clear {
  position: absolute; right: 4px; background: none; border: none;
  cursor: pointer; font-size: 12px; color: var(--pf-text-muted, #9ca3af);
  padding: 2px 4px; line-height: 1;
}
.search-clear:hover { color: var(--pf-text, #111); }

/* Type tabs */
.sheet-type-tabs {
  display: flex; gap: 2px; padding: 0 20px;
  border-bottom: 1px solid var(--pf-border, #e5e7eb);
  flex-shrink: 0; overflow-x: auto;
}
.type-tab {
  padding: 8px 14px; font-size: 12px; border: none; background: none;
  cursor: pointer; color: var(--pf-text-secondary, #6b7280);
  border-bottom: 2px solid transparent; white-space: nowrap;
}
.type-tab:hover { color: var(--pf-text, #111); }
.type-tab.active {
  color: var(--pf-primary, #3b82f6);
  border-bottom-color: var(--pf-primary, #3b82f6);
  font-weight: 500;
}
.tab-count {
  font-size: 10px; background: var(--pf-bg-subtle, #f3f4f6);
  padding: 1px 5px; border-radius: 8px; margin-left: 4px;
}

/* Error */
.sheet-error {
  margin: 8px 20px 0; padding: 6px 12px; border-radius: 6px;
  background: #fef2f2; color: #dc2626; font-size: 12px;
  display: flex; justify-content: space-between; align-items: center;
}
.sheet-error button { background: none; border: none; cursor: pointer; font-size: 14px; }

/* Body / Table */
.sheet-body { flex: 1; overflow: auto; }
.sheet-loading, .sheet-empty { padding: 40px; text-align: center; color: var(--pf-text-muted, #9ca3af); font-size: 13px; }

.sheet-table {
  width: 100%; border-collapse: collapse; font-size: 12px;
}
.sheet-table th {
  position: sticky; top: 0; z-index: 2;
  background: var(--pf-bg-elevated, #f9fafb);
  padding: 8px 12px; text-align: left; font-weight: 600; font-size: 11px;
  color: var(--pf-text-secondary, #6b7280); text-transform: uppercase; letter-spacing: 0.3px;
  border-bottom: 2px solid var(--pf-border, #e5e7eb);
  white-space: nowrap;
}
.sheet-table td {
  padding: 0; border-bottom: 1px solid var(--pf-border-light, #f3f4f6);
}

/* Column filter row */
.filter-row th {
  padding: 4px 4px; background: var(--pf-bg-elevated, #f9fafb);
  border-bottom: 2px solid var(--pf-border, #e5e7eb);
}
.col-filter {
  width: 100%; padding: 3px 6px; border: 1px solid var(--pf-border, #e5e7eb);
  border-radius: 4px; font-size: 11px; background: var(--pf-bg, #fff);
  box-sizing: border-box;
}
.col-filter:focus { border-color: var(--pf-primary, #3b82f6); outline: none; }
.col-filter::placeholder { color: var(--pf-text-muted, #ccc); }
.sheet-table tr:hover td { background: var(--pf-bg-hover, #f0f7ff); }

.row-num {
  width: 40px; text-align: center; color: var(--pf-text-muted, #9ca3af);
  font-size: 10px; background: var(--pf-bg-subtle, #f9fafb) !important;
  position: sticky; left: 0; z-index: 1;
  padding: 6px 8px !important;
}
.sheet-table th.row-num { z-index: 3; }

/* Cells */
.sheet-cell {
  max-width: 280px; cursor: default;
}
.sheet-cell:hover { background: var(--pf-bg-subtle, #f0f4ff); }
.cell-value {
  display: block; padding: 6px 12px;
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
  max-width: 280px;
}
.ref-cell .cell-value { color: var(--pf-primary, #3b82f6); font-style: italic; }
.sheet-cell.editing { padding: 0; background: #fff; }
.cell-input {
  width: 100%; padding: 6px 12px; border: 2px solid var(--pf-primary, #3b82f6);
  font-size: 12px; outline: none; background: #fff;
  box-sizing: border-box;
}

/* Row actions */
.row-actions { width: 50px; text-align: center; padding: 4px !important; }
.sheet-table th.row-actions { text-align: center; }

/* Pagination */
.sheet-pagination {
  display: flex; align-items: center; justify-content: center; gap: 12px;
  padding: 10px 20px; border-top: 1px solid var(--pf-border, #e5e7eb);
  flex-shrink: 0; font-size: 12px;
}
.sheet-pagination button {
  padding: 4px 12px; border: 1px solid var(--pf-border, #e5e7eb);
  border-radius: 4px; background: var(--pf-bg, #fff); cursor: pointer; font-size: 12px;
}
.sheet-pagination button:disabled { opacity: 0.4; cursor: not-allowed; }

/* Add Row */
.sheet-add-row-overlay {
  position: absolute; inset: 0; background: rgba(0,0,0,0.3);
  display: flex; align-items: center; justify-content: center; z-index: 10;
  border-radius: 12px;
}
.sheet-add-row {
  background: var(--pf-bg, #fff); border-radius: 10px; padding: 20px;
  width: 400px; max-height: 70vh; overflow-y: auto;
  box-shadow: 0 8px 30px rgba(0,0,0,0.2);
}
.sheet-add-row h4 { margin: 0 0 14px; font-size: 14px; }
.add-row-fields { display: flex; flex-direction: column; gap: 8px; margin-bottom: 14px; }
.add-row-field label { font-size: 11px; font-weight: 500; color: var(--pf-text-secondary, #6b7280); margin-bottom: 2px; display: block; }
.add-row-field input {
  width: 100%; padding: 6px 10px; border: 1px solid var(--pf-border, #e5e7eb);
  border-radius: 6px; font-size: 12px; box-sizing: border-box;
}
.add-row-actions { display: flex; gap: 8px; justify-content: flex-end; }

/* Audit Panel */
.sheet-audit-overlay {
  position: absolute; inset: 0; background: rgba(0,0,0,0.2);
  display: flex; justify-content: flex-end; z-index: 10;
  border-radius: 12px;
}
.sheet-audit-panel {
  background: var(--pf-bg, #fff); width: 380px; height: 100%;
  border-left: 1px solid var(--pf-border, #e5e7eb);
  display: flex; flex-direction: column;
  border-radius: 0 12px 12px 0;
  box-shadow: -4px 0 20px rgba(0,0,0,0.1);
}
.audit-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 16px; border-bottom: 1px solid var(--pf-border, #e5e7eb);
}
.audit-header h4 { margin: 0; font-size: 14px; }
.audit-list { flex: 1; overflow-y: auto; padding: 8px; }

.audit-entry {
  padding: 10px 12px; border-radius: 8px; margin-bottom: 6px;
  background: var(--pf-bg-subtle, #f9fafb); font-size: 12px;
}
.audit-entry.audit-delete_row { background: #fef2f2; }
.audit-entry.audit-add_row { background: #f0fdf4; }
.audit-meta { display: flex; justify-content: space-between; margin-bottom: 4px; }
.audit-action { font-weight: 500; }
.audit-time { color: var(--pf-text-muted, #9ca3af); font-size: 10px; }
.audit-detail { font-size: 11px; color: var(--pf-text-secondary, #6b7280); }
.audit-entity { display: flex; align-items: center; gap: 6px; margin-bottom: 4px; }
.audit-entity-type {
  display: inline-block; padding: 1px 6px; border-radius: 3px;
  background: var(--pf-purple-lighter, #EDE9FE); color: var(--pf-purple, #6B21A8);
  font-size: 10px; font-weight: 500;
}
.audit-entity-label { font-size: 12px; font-weight: 600; color: var(--pf-text, #111); }
.audit-prop { font-weight: 500; color: var(--pf-text, #111); }
.audit-old { text-decoration: line-through; color: #dc2626; margin: 0 4px; }
.audit-new { color: #16a34a; font-weight: 500; }
.audit-snapshot { display: flex; flex-direction: column; gap: 2px; margin-top: 4px; }
.audit-snap-item { font-size: 10px; color: var(--pf-text-muted, #9ca3af); }
